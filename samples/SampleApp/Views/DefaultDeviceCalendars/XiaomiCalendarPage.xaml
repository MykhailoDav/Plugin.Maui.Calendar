<?xml version="1.0" encoding="utf-8"?>

<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:plugin="clr-namespace:Plugin.Maui.Calendar.Controls;assembly=Plugin.Maui.Calendar"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             xmlns:vm="clr-namespace:SampleApp.ViewModels"
             xmlns:models="using:SampleApp.Model"
             x:DataType="vm:XiaomiCalendarViewModel"
             Shell.TabBarIsVisible="False"
             xmlns:controls="clr-namespace:SampleApp.Controls"
             BackgroundColor="{toolkit:AppThemeResource BackgroundColor}"
             x:Class="SampleApp.Views.XiaomiCalendarPage">
        <ContentPage.Resources>
                <ResourceDictionary>
                        <toolkit:AppThemeColor
                                x:Key="BackgroundColor"
                                Dark="{StaticResource Black}"
                                Light="#f5f5f5"/>
                        <toolkit:AppThemeColor
                                x:Key="BorderColor"
                                Dark="#191a1c"
                                Light="White"/>
                        <toolkit:AppThemeColor
                                x:Key="StrokeColor"
                                Dark="#232426"
                                Light="#e2e2e2"/>
                        <toolkit:AppThemeColor
                                x:Key="OtherMonthTextColor"
                                Dark="#3f3f3f"
                                Light="#c3c3c3"/>
                        <toolkit:AppThemeColor
                                x:Key="DaysTitleTextColor"
                                Dark="#646464"
                                Light="#949494"/>
                        <toolkit:AppThemeColor
                                x:Key="TodayDayTextColor"
                                Dark="#0c80de"
                                Light="#2f91c2"/>
                        <toolkit:AppThemeColor
                                x:Key="WeekendDaysTextColor"
                                Dark="#b43e3e"
                                Light="#a33b42"/>
                        <toolkit:AppThemeColor
                                x:Key="ButtonColor"
                                Dark="#3b3b3b"
                                Light="White"/>

                        <Style TargetType="Border"
                               x:Key="BorderStyle">
                                <Setter Property="StrokeShape"
                                        Value="RoundRectangle 16"/>
                                <Setter Property="Margin"
                                        Value="20,5"/>
                                <Setter Property="Padding"
                                        Value="20"/>
                                <Setter Property="Stroke"
                                        Value="{toolkit:AppThemeResource StrokeColor}"/>
                                <Setter Property="BackgroundColor"
                                        Value="{toolkit:AppThemeResource BorderColor}"/>
                        </Style>
                        <Style TargetType="Label"
                               x:Key="LabelStyle">
                                <Setter Property="FontSize"
                                        Value="18"/>
                                <Setter Property="VerticalTextAlignment"
                                        Value="Center"/>
                                <Setter Property="HorizontalTextAlignment"
                                        Value="Start"/>
                        </Style>
                        <Style TargetType="Label"
                               x:Key="TitleLabelStyle">
                                <Setter Property="FontSize"
                                        Value="12"/>
                        </Style>
                </ResourceDictionary>
        </ContentPage.Resources>
        <Grid VerticalOptions="Fill"
              RowDefinitions="*,Auto"
              ColumnDefinitions="*,Auto">
                <plugin:Calendar
                        Grid.RowSpan="2"
                        Grid.ColumnSpan="2"
                        x:Name="Calendar"
                        EventsScrollViewVisible="True"
                        DeselectedDayTextColor="{toolkit:AppThemeResource DeselectedDayLabelTextColor}"
                        Day="{Binding Day}"
                        DayViewCornerRadius="60"
                        HeaderSectionVisible="False"
                        DaysTitleLabelStyle="{StaticResource TitleLabelStyle}"
                        TodayOutlineColor="Transparent"
                        DayViewFontSize="18"
                        AllowDeselect="False"
                        DayViewSize="50"
                        SelectedDate="{Binding SelectedDate}"
                        SelectedTodayTextColor="{toolkit:AppThemeResource TodayDayTextColor}"
                        SelectedDateColor="{toolkit:AppThemeResource DeselectedDayLabelTextColor}"
                        TodayTextColor="{toolkit:AppThemeResource TodayDayTextColor}"
                        DaysTitleWeekendColor="{toolkit:AppThemeResource DaysTitleTextColor}"
                        WeekendDayColor="{toolkit:AppThemeResource WeekendDaysTextColor}"
                        OtherMonthDayColor="{toolkit:AppThemeResource OtherMonthTextColor}"
                        DaysTitleColor="{toolkit:AppThemeResource DaysTitleTextColor}"
                        Month="{Binding Month}"
                        FooterSectionVisible="False"
                        FooterArrowVisible="False"
                        SelectedDayBackgroundColor="{toolkit:AppThemeResource StrokeColor}"
                        Events="{Binding Events}"
                        Year="{Binding Year}">
                        <plugin:Calendar.EventTemplate>
                                <DataTemplate x:DataType="models:EventModel">
                                        <Border Style="{StaticResource BorderStyle}">
                                                <VerticalStackLayout
                                                        HorizontalOptions="Fill"
                                                        VerticalOptions="Fill">
                                                        <Label Style="{StaticResource LabelStyle}"
                                                               Text="{Binding Name}"/>
                                                        <Label
                                                                FontSize="14"
                                                                Margin="0,10,0,0"
                                                                TextColor="{toolkit:AppThemeResource StrokeColor}"
                                                                LineBreakMode="WordWrap"
                                                                Text="{Binding Description}"/>
                                                </VerticalStackLayout>
                                                <Border.GestureRecognizers>
                                                        <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type vm:XiaomiCalendarViewModel}}, Path=EventTappedCommand}"
                                                                              CommandParameter="{Binding .}"/>
                                                </Border.GestureRecognizers>
                                        </Border>
                                </DataTemplate>
                        </plugin:Calendar.EventTemplate>
                        <plugin:Calendar.EmptyTemplate>
                                <DataTemplate>
                                        <Border Style="{StaticResource BorderStyle}">
                                                <Label Style="{StaticResource LabelStyle}"
                                                       Text="No events"/>
                                        </Border>
                                </DataTemplate>
                        </plugin:Calendar.EmptyTemplate>
                </plugin:Calendar>
                <Button Grid.Row="1"
                        Grid.Column="1"
                        Margin="35"
                        VerticalOptions="End"
                        Text="+"
                        HorizontalOptions="End"
                        Command="{Binding AddEventCommand}"
                        BackgroundColor="{toolkit:AppThemeResource ButtonColor}"
                        FontSize="50"
                        TextColor="{toolkit:AppThemeResource TodayDayTextColor}"
                        CornerRadius="30"
                        Padding="0,0,0,8"
                        HeightRequest="60"
                        WidthRequest="60"/>
        </Grid>
</ContentPage>